CREATE DATABASE SUPERSTORE_DB ;
USE SUPERSTORE_DB;
RENAME TABLE `superstores datasets` TO SUPER;

 -- EXPLORING ALL COLUMNS FROM TABLES OF LIMIT 10
SELECT * FROM SUPER LIMIT 10;

-- SALES BY CATEGORY
SELECT CATEGORY, SUM(SALES) AS total_sales
FROM SUPER
GROUP BY CATEGORY;


-- TOP 5 PRODUCTS BY SALES 
SELECT `PRODUCT NAME`,SUM(SALES) AS TOTAL_SALES
FROM SUPER
GROUP BY `PRODUCT NAME`
ORDER BY TOTAL_SALES DESC
LIMIT 5;

-- state wise profit  
SELECT STATE,ROUND(SUM(SALES),2)AS PROFIT FROM SUPER
GROUP BY STATE
ORDER BY PROFIT DESC;

-- TOTAL NUMBER OF CONSUMERS SEGMENTS
SELECT SEGMENT,COUNT(SEGMENT)
FROM SUPER
WHERE SEGMENT="CONSUMER"
GROUP BY SEGMENT;

-- TOTAL NUMBER OF CORPORATE SEGMENT
SELECT SEGMENT,COUNT(SEGMENT)
FROM SUPER
WHERE SEGMENT="corporate"
GROUP BY SEGMENT;


-- MONTHLY SALES TREND
SELECT DATE_FORMAT(`Order Date`, '%Y-%M') AS month, SUM(Sales) AS monthly_sales
FROM SUPER
GROUP BY MONTH
ORDER BY MONTH;

-- LIST OF CUSTOMERS WHO ARE REPEATED

SELECT `Customer Name`, COUNT(*) AS order_count
FROM SUPER
GROUP BY `Customer Name`
HAVING order_count > 1
ORDER BY order_count DESC;

-- Monthly sales trend
SELECT DATE_FORMAT(STR_TO_DATE(	`Order Date`, '%m/%d/%Y'), '%Y-%m') AS month,
       SUM(Sales) AS monthly_sales
FROM SUPER
GROUP BY month
ORDER BY month;



